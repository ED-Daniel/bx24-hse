# ======================================
# CRM Integration Service - Configuration
# ======================================

# Application Settings
APP_NAME="CRM Integration Service"
ENVIRONMENT=development  # development, production, testing
DEBUG=True

# Server Settings
HOST=0.0.0.0
PORT=8000

# ======================================
# Database Configuration
# ======================================

# PostgreSQL Connection
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_SERVER=localhost
POSTGRES_PORT=5432
POSTGRES_DB=fastapi_db

# Full Database URL (alternative to individual settings)
DATABASE_URL=postgresql+psycopg2://postgres:postgres@localhost:5432/fastapi_db

# ======================================
# Bitrix24 Integration
# ======================================

# Bitrix24 Webhook URL
# Получить в: Битрикс24 -> Настройки -> Настройки REST API -> Входящий вебхук
# Формат: https://your-domain.bitrix24.ru/rest/1/your-webhook-token/
BITRIX24_WEBHOOK_URL=https://your-domain.bitrix24.ru/rest/1/your-webhook-token/

# Retry Settings for Bitrix24 API
# Настройки автоматического повтора при ошибках сети
BITRIX24_RETRY_MAX_ATTEMPTS=3     # Максимум попыток (default: 3)
BITRIX24_RETRY_DELAY=1.0          # Начальная задержка в секундах (default: 1.0)
BITRIX24_RETRY_BACKOFF=2.0        # Множитель увеличения задержки (default: 2.0)

# ======================================
# Cache Settings
# ======================================

# Enable/Disable Caching
CACHE_ENABLED=True

# Cache TTL (Time To Live) in seconds
CACHE_TTL_POLL_FORMS=600               # Опросные формы: 10 минут
CACHE_TTL_EDUCATIONAL_PROGRAMS=600     # Образовательные программы: 10 минут
CACHE_TTL_CONTACTS=300                 # Контакты: 5 минут
CACHE_TTL_DEALS=60                     # Сделки: 1 минута

# ======================================
# Batch Operations
# ======================================

# Enable/Disable Batch Requests to Bitrix24
BATCH_ENABLED=True

# Maximum batch size (Bitrix24 limit is 50)
BATCH_SIZE=50

# ======================================
# Logging Configuration
# ======================================

# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# Log format
LOG_FORMAT="%(asctime)s - %(name)s - %(levelname)s - %(message)s"

# ======================================
# Security
# ======================================

# Secret key for session management (change in production!)
SECRET_KEY=change-this-secret-key-in-production

# ======================================
# Performance & Optimization Tips
# ======================================

# Рекомендации для production:
#
# 1. Кеширование:
#    - Для редко меняющихся справочников увеличьте TTL до 1800 (30 минут)
#    - Для часто обновляемых данных (контакты, сделки) используйте меньший TTL
#
# 2. Batch операции:
#    - Включайте BATCH_ENABLED=True для обработки нескольких образовательных программ
#    - Помогает снизить количество запросов к Bitrix24 API
#
# 3. Retry логика:
#    - BITRIX24_RETRY_MAX_ATTEMPTS=5 для production (больше попыток)
#    - BITRIX24_RETRY_DELAY=2.0 для более терпеливых повторов
#
# 4. Логирование:
#    - LOG_LEVEL=WARNING для production (меньше логов)
#    - LOG_LEVEL=DEBUG для отладки
#
# 5. База данных:
#    - Используйте connection pooling в production
#    - Настройте PostgreSQL для оптимальной производительности

# ======================================
# Docker Settings (for docker-compose)
# ======================================

# Эти переменные используются в docker-compose.yml
# Они будут автоматически подхвачены контейнерами
